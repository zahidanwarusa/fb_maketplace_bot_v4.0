<!-- Media Library Tab Component -->
<div v-if="activeTab === 'media'">
    <div class="card">
        <div class="card-header">
            <div class="card-title">Media Library</div>
            <div style="display: flex; gap: 12px;">
                <button @click="createFolderPrompt" class="btn btn-success">
                    <i class="fas fa-folder-plus"></i> New Folder
                </button>
                <button @click="openFileUpload('standalone')" class="btn btn-success">
                    <i class="fas fa-upload"></i> Upload
                </button>
                <button @click="loadDriveStructure" class="btn btn-secondary">
                    <i class="fas fa-sync-alt"></i> Refresh
                </button>
            </div>
        </div>

        <!-- Loading State -->
        <div v-if="loadingMedia" class="empty-state">
            <div class="spinner" style="margin: 0 auto 20px;"></div>
            <p style="font-weight: 600; color: #4a5568;">Loading media files...</p>
        </div>

        <!-- Empty State -->
        <div v-else-if="driveStructure.root.files.length === 0 && driveStructure.folders.length === 0" class="empty-state">
            <i class="fas fa-folder-open"></i>
            <h3 style="font-size: 20px; font-weight: 600; color: #1a202c; margin-bottom: 8px;">No files found</h3>
            <p style="margin-bottom: 24px;">Upload some files to get started</p>
            <button @click="openFileUpload('standalone')" class="btn btn-success">
                <i class="fas fa-upload"></i> Upload Files
            </button>
        </div>

        <!-- Content -->
        <div v-else>
            <!-- Root Files -->
            <div v-if="driveStructure.root.files.length > 0" style="margin-bottom: 32px;">
                <h4 style="font-weight: 600; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                    <i class="fas fa-folder-open" style="color: #667eea;"></i>
                    Root Files ([[ driveStructure.root.file_count ]])
                </h4>
                <div class="file-grid">
                    <div v-for="file in driveStructure.root.files" :key="file.id" class="file-card">
                        <div style="aspect-ratio: 1; background: #f1f3f5; border-radius: 8px; margin-bottom: 12px; display: flex; align-items: center; justify-content: center; overflow: hidden;">
                            <img v-if="file.thumbnailLink" :src="file.thumbnailLink" :alt="file.name" style="width: 100%; height: 100%; object-fit: cover;">
                            <i v-else :class="getFileIcon(file.mimeType)" style="font-size: 40px; color: #cbd5e0;"></i>
                        </div>
                        <div style="font-size: 13px; font-weight: 600; color: #1a202c; margin-bottom: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;" :title="file.name">[[ file.name ]]</div>
                        <div style="font-size: 12px; color: #718096; margin-bottom: 12px;">[[ file.sizeFormatted ]]</div>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 6px;">
                            <button @click="viewFile(file)" class="btn btn-secondary" style="padding: 6px; font-size: 12px;">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button @click="confirmDeleteMedia(file)" class="btn btn-danger" style="padding: 6px; font-size: 12px;">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Folders -->
            <div v-if="driveStructure.folders.length > 0">
                <h4 style="font-weight: 600; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                    <i class="fas fa-folder" style="color: #667eea;"></i>
                    Folders ([[ driveStructure.folders.length ]])
                </h4>

                <div v-for="folder in driveStructure.folders" :key="folder.id" 
                     style="background: white; border: 2px solid #e2e8f0; border-radius: 12px; padding: 16px; margin-bottom: 16px;">

                    <!-- Folder Header -->
                    <div style="display: flex; justify-content: space-between; align-items: center; cursor: pointer;"
                         @click="toggleFolder(folder.id)">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <i :class="showFolderContent[folder.id] ? 'fas fa-folder-open' : 'fas fa-folder'" 
                               style="font-size: 24px; color: #667eea;"></i>
                            <div>
                                <div style="font-weight: 600; font-size: 16px; color: #1a202c;">[[ folder.name ]]</div>
                                <div style="color: #718096; font-size: 13px;">[[ folder.file_count ]] file(s)</div>
                            </div>
                        </div>
                        <div style="display: flex; gap: 8px;">
                            <button @click.stop="openFileUploadToFolder(folder.name)" 
                                    class="btn btn-success" 
                                    style="padding: 8px 12px;"
                                    title="Upload to this folder">
                                <i class="fas fa-upload"></i>
                            </button>
                            <button @click.stop="deleteFolder(folder)" 
                                    class="btn btn-danger" 
                                    style="padding: 8px 12px;"
                                    title="Delete folder">
                                <i class="fas fa-trash"></i>
                            </button>
                            <button class="btn btn-secondary" style="padding: 8px 12px;">
                                <i :class="showFolderContent[folder.id] ? 'fas fa-chevron-up' : 'fas fa-chevron-down'"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Folder Files (Expanded) -->
                    <div v-if="showFolderContent[folder.id] && folder.files.length > 0" 
                         style="margin-top: 16px; padding-top: 16px; border-top: 1px solid #e2e8f0;">
                        <div class="file-grid">
                            <div v-for="file in folder.files" :key="file.id" class="file-card">
                                <div style="aspect-ratio: 1; background: #f1f3f5; border-radius: 8px; margin-bottom: 12px; display: flex; align-items: center; justify-content: center; overflow: hidden;">
                                    <img v-if="file.thumbnailLink" :src="file.thumbnailLink" :alt="file.name" style="width: 100%; height: 100%; object-fit: cover;">
                                    <i v-else :class="getFileIcon(file.mimeType)" style="font-size: 40px; color: #cbd5e0;"></i>
                                </div>
                                <div style="font-size: 13px; font-weight: 600; color: #1a202c; margin-bottom: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;" :title="file.name">[[ file.name ]]</div>
                                <div style="font-size: 12px; color: #718096; margin-bottom: 12px;">[[ file.sizeFormatted ]]</div>
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 6px;">
                                    <button @click="viewFile(file)" class="btn btn-secondary" style="padding: 6px; font-size: 12px;">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button @click="confirmDeleteMedia(file)" class="btn btn-danger" style="padding: 6px; font-size: 12px;">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Empty Folder State -->
                    <div v-else-if="showFolderContent[folder.id] && folder.files.length === 0"
                         style="padding: 30px; text-align: center; color: #718096; background: #f7fafc; border-radius: 8px; margin-top: 16px;">
                        <i class="fas fa-inbox" style="font-size: 32px; opacity: 0.3; margin-bottom: 8px;"></i>
                        <p>No files in this folder</p>
                        <button @click="openFileUploadToFolder(folder.name)" class="btn btn-success" style="margin-top: 12px;">
                            <i class="fas fa-upload"></i> Upload Files
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
