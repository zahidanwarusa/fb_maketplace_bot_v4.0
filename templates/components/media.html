<!-- Media Library Tab Component -->
<div v-if="activeTab === 'media'">
    <div class="card">
        <div class="card-header">
            <div class="card-title">Media Library</div>
            <div style="display: flex; gap: 12px;">
                <button @click="createFolderPrompt" class="btn btn-success"><i class="fas fa-folder-plus"></i> New Folder</button>
                <button @click="openFileUpload('standalone')" class="btn btn-success"><i class="fas fa-upload"></i> Upload</button>
                <button @click="loadDriveStructure" class="btn btn-secondary"><i class="fas fa-sync-alt"></i> Refresh</button>
            </div>
        </div>
        <div v-if="loadingMedia" class="empty-state"><div class="spinner" style="margin: 0 auto 20px;"></div><p>Loading media files...</p></div>
        <div v-else-if="driveStructure.root.files.length === 0 && driveStructure.folders.length === 0" class="empty-state">
            <i class="fas fa-folder-open"></i><h3>No files found</h3>
            <button @click="openFileUpload('standalone')" class="btn btn-success" style="margin-top: 16px;"><i class="fas fa-upload"></i> Upload Files</button>
        </div>
        <div v-else>
            <div v-if="driveStructure.root.files.length > 0" style="margin-bottom: 32px;">
                <h4 style="font-weight: 600; margin-bottom: 16px;"><i class="fas fa-folder-open" style="color: #667eea;"></i> Root Files ([[ driveStructure.root.file_count ]])</h4>
                <div class="file-grid">
                    <div v-for="file in driveStructure.root.files" :key="file.id" class="file-card">
                        <div style="aspect-ratio: 1; background: #f1f3f5; border-radius: 8px; margin-bottom: 12px; display: flex; align-items: center; justify-content: center; overflow: hidden;">
                            <img v-if="file.thumbnailLink" :src="file.thumbnailLink" style="width: 100%; height: 100%; object-fit: cover;">
                            <i v-else :class="getFileIcon(file.mimeType)" style="font-size: 40px; color: #cbd5e0;"></i>
                        </div>
                        <div style="font-size: 13px; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">[[ file.name ]]</div>
                        <div style="font-size: 12px; color: #718096; margin-bottom: 12px;">[[ file.sizeFormatted ]]</div>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 6px;">
                            <button @click="viewFile(file)" class="btn btn-secondary" style="padding: 6px; font-size: 12px;"><i class="fas fa-eye"></i></button>
                            <button @click="confirmDeleteMedia(file)" class="btn btn-danger" style="padding: 6px; font-size: 12px;"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                </div>
            </div>
            <div v-if="driveStructure.folders.length > 0">
                <h4 style="font-weight: 600; margin-bottom: 16px;"><i class="fas fa-folder" style="color: #667eea;"></i> Folders ([[ driveStructure.folders.length ]])</h4>
                <div v-for="folder in driveStructure.folders" :key="folder.id" style="background: white; border: 2px solid #e2e8f0; border-radius: 12px; padding: 16px; margin-bottom: 16px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; cursor: pointer;" @click="toggleFolder(folder.id)">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <i :class="showFolderContent[folder.id] ? 'fas fa-folder-open' : 'fas fa-folder'" style="font-size: 24px; color: #667eea;"></i>
                            <div><div style="font-weight: 600;">[[ folder.name ]]</div><div style="color: #718096; font-size: 13px;">[[ folder.file_count ]] file(s)</div></div>
                        </div>
                        <div style="display: flex; gap: 8px;">
                            <button @click.stop="openFileUploadToFolder(folder.name)" class="btn btn-success" style="padding: 8px 12px;"><i class="fas fa-upload"></i></button>
                            <button @click.stop="deleteFolder(folder)" class="btn btn-danger" style="padding: 8px 12px;"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                    <div v-if="showFolderContent[folder.id] && folder.files.length > 0" style="margin-top: 16px; padding-top: 16px; border-top: 1px solid #e2e8f0;">
                        <div class="file-grid">
                            <div v-for="file in folder.files" :key="file.id" class="file-card">
                                <div style="aspect-ratio: 1; background: #f1f3f5; border-radius: 8px; margin-bottom: 12px; display: flex; align-items: center; justify-content: center; overflow: hidden;">
                                    <img v-if="file.thumbnailLink" :src="file.thumbnailLink" style="width: 100%; height: 100%; object-fit: cover;">
                                    <i v-else :class="getFileIcon(file.mimeType)" style="font-size: 40px; color: #cbd5e0;"></i>
                                </div>
                                <div style="font-size: 13px; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">[[ file.name ]]</div>
                                <div style="font-size: 12px; color: #718096; margin-bottom: 12px;">[[ file.sizeFormatted ]]</div>
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 6px;">
                                    <button @click="viewFile(file)" class="btn btn-secondary" style="padding: 6px; font-size: 12px;"><i class="fas fa-eye"></i></button>
                                    <button @click="confirmDeleteMedia(file)" class="btn btn-danger" style="padding: 6px; font-size: 12px;"><i class="fas fa-trash"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
