<!-- Profiles Tab Component - Edge Profile Management -->
<div v-if="activeTab === 'profiles'">
    <!-- Add Profile Form Card -->
    <div class="card" style="margin-bottom: 24px;">
        <div class="card-header">
            <div class="card-title">
                <i class="fab fa-edge" style="color: #0078d4; margin-right: 8px;"></i>
                [[ editingProfile ? 'Edit Edge Profile' : 'Add New Edge Profile' ]]
            </div>
            <button v-if="editingProfile" @click="cancelProfileEdit" class="btn btn-secondary">
                <i class="fas fa-times"></i> Cancel
            </button>
        </div>
        <form @submit.prevent="editingProfile ? updateProfile() : addProfile()">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px; margin-bottom: 16px;">
                <div>
                    <label>Profile Name <span style="color: #f56565;">*</span></label>
                    <input v-model="profileForm.profile_name" type="text" required placeholder="e.g., Work Profile, Personal">
                </div>
                <div>
                    <label>Profile Path <span style="color: #f56565;">*</span></label>
                    <div style="display: flex; gap: 8px;">
                        <input v-model="profileForm.profile_path" type="text" required placeholder="C:\Users\...\Edge\User Data\Profile 1" style="flex: 1;">
                        <button type="button" @click="validatePath" class="btn btn-secondary" style="padding: 10px 16px;" title="Validate Path">
                            <i class="fas fa-check-circle"></i>
                        </button>
                    </div>
                </div>
                <div>
                    <label>Location (for Marketplace)</label>
                    <input v-model="profileForm.location" type="text" placeholder="e.g., Washington D.C.">
                </div>
            </div>
            <div style="display: flex; justify-content: flex-end; gap: 12px;">
                <button v-if="editingProfile" type="button" @click="cancelProfileEdit" class="btn btn-secondary">Cancel</button>
                <button type="submit" class="btn btn-success">
                    <i :class="editingProfile ? 'fas fa-save' : 'fas fa-plus-circle'"></i>
                    [[ editingProfile ? 'Update Profile' : 'Add Profile' ]]
                </button>
            </div>
        </form>
    </div>

    <!-- Profiles List Card -->
    <div class="card">
        <div class="card-header">
            <div class="card-title">Edge Profiles</div>
            <div style="display: flex; gap: 12px; align-items: center;">
                <span class="badge badge-info">[[ profiles.length ]] Total</span>
                <span class="badge badge-success">[[ selectedProfiles.length ]] Selected</span>
                <button @click="loadProfiles" class="btn btn-secondary"><i class="fas fa-sync-alt"></i> Refresh</button>
            </div>
        </div>

        <div v-if="loadingProfiles" class="empty-state">
            <div class="spinner" style="margin: 0 auto 20px;"></div>
            <p style="font-weight: 600; color: #4a5568;">Loading profiles...</p>
        </div>

        <div v-else-if="profiles.length === 0" class="empty-state">
            <i class="fab fa-edge" style="font-size: 64px; color: #0078d4; opacity: 0.3; margin-bottom: 16px;"></i>
            <h3 style="font-size: 20px; font-weight: 600; color: #1a202c; margin-bottom: 8px;">No Edge Profiles</h3>
            <p style="color: #718096;">Add your first Edge profile to get started</p>
        </div>

        <!-- LIST VIEW (replaced card grid) -->
        <div v-else class="table-container">
            <table>
                <thead>
                    <tr>
                        <th style="width: 40px;"></th>
                        <th>Profile Name</th>
                        <th>Profile Path</th>
                        <th>Location</th>
                        <th style="width: 100px;">Status</th>
                        <th style="width: 140px;">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="profile in profiles" :key="profile.id" 
                        :style="[
                            !profile.is_active ? 'opacity: 0.6;' : '',
                            selectedProfiles.some(p => p.id === profile.id) ? 'background: #eef2ff;' : ''
                        ].join(' ')">
                        <td>
                            <input 
                                type="checkbox" 
                                :checked="selectedProfiles.some(p => p.id === profile.id)" 
                                @change="onProfileCheckboxChange($event, profile)" 
                                :disabled="!profile.is_active" 
                                class="custom-checkbox">
                        </td>
                        <td>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <div style="width: 32px; height: 32px; background: linear-gradient(135deg, #0078d4 0%, #106ebe 100%); border-radius: 6px; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                                    <i class="fab fa-edge" style="color: white; font-size: 14px;"></i>
                                </div>
                                <span style="font-weight: 600; color: #1a202c;">[[ profile.profile_name ]]</span>
                            </div>
                        </td>
                        <td>
                            <div style="max-width: 300px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" :title="profile.profile_path">
                                <span style="color: #718096; font-size: 13px; font-family: monospace;">[[ profile.profile_path ]]</span>
                            </div>
                        </td>
                        <td>
                            <div style="display: flex; align-items: center; gap: 6px;">
                                <input 
                                    type="text" 
                                    v-model="profile.location" 
                                    placeholder="Enter location" 
                                    @blur="updateProfileLocation(profile)" 
                                    @keyup.enter="updateProfileLocation(profile)"
                                    style="font-size: 13px; padding: 6px 10px; width: 150px;">
                            </div>
                        </td>
                        <td>
                            <span :class="profile.is_active ? 'badge badge-success' : 'badge badge-secondary'" style="font-size: 11px;">
                                <span :class="profile.is_active ? 'status-dot active' : 'status-dot inactive'"></span>
                                [[ profile.is_active ? 'Active' : 'Inactive' ]]
                            </span>
                        </td>
                        <td>
                            <div style="display: flex; gap: 6px;">
                                <button @click="editProfileClick(profile)" class="btn btn-secondary" style="padding: 6px 10px; font-size: 12px;" title="Edit Profile">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button @click="toggleProfileActive(profile)" :class="profile.is_active ? 'btn btn-warning' : 'btn btn-success'" style="padding: 6px 10px; font-size: 12px;" :title="profile.is_active ? 'Deactivate' : 'Activate'">
                                    <i :class="profile.is_active ? 'fas fa-pause' : 'fas fa-play'"></i>
                                </button>
                                <button @click="confirmDeleteProfile(profile)" class="btn btn-danger" style="padding: 6px 10px; font-size: 12px;" title="Delete Profile">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>